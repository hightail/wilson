/*! wilson 2015-05-20 */
"use strict";!function(a,b,c){var d=null,e=null,f={components:{},behaviors:{},services:{},parsers:{},filters:{},guides:{}},g=null,h=null,i=null,j=b.module("wilson",["ngRoute","LocalStorageModule","wilson.config","wilson.i18n","wilson.prerender"]).config(["$interpolateProvider","$locationProvider","i18nextServiceProvider","$routeProvider","localStorageServiceProvider","$compileProvider","$controllerProvider","$provide",function(a,d,f,j,k,l,m,n){var o=b.wilson.config;g=l,h=m,i=n,a.startSymbol("[["),a.endSymbol("]]"),f.init({lng:o.i18n.lng,resStore:o.i18n.resStore,ns:{namespaces:o.i18n.namespaces},fallbackToDefaultNS:!1,nsseparator:":::",keyseparator:"::",useCookie:!1,useLocalStorage:o.i18n.useLocalStorage,localStorageExpirationTime:o.i18n.localStorageExpirationTime,supportedLngs:c.pluck(o.i18n.supportedLngs,"locale"),languageData:o.i18n.supportedLngs,fallbackLng:o.i18n.fallbackLng,sendMissing:o.i18n.sendMissing,sendMissingTo:"all",resPostPath:"/locales/add/__lng__/__ns__",resSetPath:"/client/locales/__lng__/__ns__.json",resGetPath:"/client/locales/__lng__/__ns__.json"}),k.setPrefix(o.app.localStoragePrefix||"wilson"),d.html5Mode(!0).hashPrefix("!"),e=j,c.each(o.routes,function(a){q(a)}),o.routes&&o.routes.length>0,e=null}]).run(["$rootScope","$templateCache","$location","localStorageService",function(a,c,d,e){a.page={title:"Wilson"},a.safeApply=function(a){var b=this.$root.$$phase;"$apply"===b||"$digest"===b?a&&"function"==typeof a&&a():this.$apply(a)},a.bindToSafeApply=function(b,c){return c=c||this,b?function(){var d=arguments;a.safeApply(function(){b.apply(c,d)})}:function(){}};var f=!1,g=function(a){if(!f){var b=d.path();f=!0,e.add("retryRoute",{path:a,originalPath:b,attempt:0}),d.path(a)}};a.$on("$routeChangeSuccess",function(){f=!1}),b.wilson.doRetryRedirect=g}]),k=function(){var a="string"==typeof navigator.userAgent?navigator.userAgent.toLowerCase():navigator.userAgent,b=parseInt((/msie (\d+)/.exec(a)||[])[1],10);return isNaN(b)&&(b=parseInt((/trident\/.*; rv:(\d+)/.exec(a)||[])[1],10)),b},l=function(a,b,d,e){if(!c.isString(b))throw new Error(a+" name must be a string!!!");var f=function(){if(!c.isFunction(d)||k(d).length)throw new Error(a+" ["+b+"] definition must be a Function with no arguments!!")},g=function(){if(!c.isFunction(d)&&!c.isArray(d))throw new Error(a+" ["+b+"] definition must be a Function or an Array!!!");if(c.isFunction(d)&&k(d).length)throw new Error(a+" ["+b+"] definition with params (i.e. injections) MUST be defined as an Array!!");if(e&&!c.isFunction(e))throw new Error(a+" link method must be a function!!!")},h=function(){if(c.isArray(d));else if(!c.isFunction(d))throw new Error(a+" ["+b+"] definition must be a Function what at least 1 argument!!")},i=function(a,b){var c=new RegExp("^"+a+".+$");if(!c.test(b))throw new Error(a+" name ["+b+"] does not match format [*-"+a+"]. Expected ["+b+"-"+a+"]. Please update the name to the proper format.")},j=function(a,b){var d=c.string.classify(a);"service"===a&&(d="[Service|Factory|Utility|Resource]");var e=c.string.classify(b),f=new RegExp("^.+"+d+"$");if(!f.test(b))throw new Error(a+" name ["+b+"] does not match format [*"+d+"]. Expected ["+e+d+"]. Please update the name to the proper format.")},k=function(a){var b=a.toString().match(/\(.*?\)/)[0].replace(/[()]/gi,"").replace(/\s/gi,"").split(",");return c.without(b,"")};if(!a)throw new Error("Failed to validate definition params. Type is null or undefined!!");switch(a){case"service":g(),j(a,b);break;case"behavior":case"filter":h();break;case"parser":h(),j(a,b);break;case"guide":f(),i(a,b)}},m=!0,n=function(a){x.config=d=a},o=function(a,b){var d=c.intersection(c.keys(a),c.keys(b));if(d.length)throw new Error("Cannot Override Original Model POJO Properties!!");var e=c.extend(a,b);return e},p=function(a){var b;return b=c.find(x.config.routes,function(b){var d=!1;if(!c.isNull(b.path)){var e=b.path.split("/"),f=a.split("/"),g=f[1].match(/^([a-z]{2}|[a-z]{2}-[a-z]{2})$/i);d=a===b.path||!g&&f[1]===e[1]||g&&f[2]===e[2]}return d}),c.isUndefined(b)&&(b=c.findWhere(x.config.routes,{path:null})),b&&b.options?c.clone(b.options):{}},q=function(a){if(!e||!m){var d="Cannot create route. No Route Provider set in Wilson!!!";throw m||(d="Legal Routing time-frame has passed!! Routing can only be performed upon initial app config!!!"),new Error(d)}if(c.isUndefined(a.path))throw new Error("Route information is invalid! Missing path definition: \n"+JSON.stringify(a,void 0,2));var f=!0,g={controller:"ht"+c.string.classify(a.component),resolve:{routeLabel:[function(){return a.label||a.component}],routeInfo:["$route","$q","$location","AppStateService","IRouteService",function(b,d,e,g,h){var i=d.defer(),j=e.path(),k=p(j);f=h.handleRouteChange(j,k,a),f||i.reject();var l={};return l=c.isObject(k.defaultParams)?c.extend(k,k.defaultParams,b.current.params):c.extend(k,b.current.params),g.setPersistentValues(a.component,l),i.resolve(l),i.promise}],$template:["ComponentLoaderService","$route","$q","$window","$templateCache","$rootScope","IRouteService",function(c,d,e,g,h,i,j){var k=e.defer();return f?(a.title?i.page.title=j.translateTitle(a.title):delete i.page.title,c.load(a.component).then(function(c){c.version!==b.wilson.config.app.version?g.location.reload():($(x.config.app.appLoaderSelector||".loading-screen").css("display","none"),k.resolve(h.get(a.component)))},function(){k.reject("<div>Failed to Load!!!</div>")}),k.promise):k.promise}],retryOriginalRoute:["$location","$route","localStorageService",function(a,b,d){var e=d.get("retryRoute");c.isObject(e)&&a.path()===e.path?e.attempt>0?e.originalPath&&e.path!==e.originalPath&&(d.remove("retryRoute"),a.path(e.originalPath)):(e.attempt++,d.add("retryRoute",e)):d.remove("retryRoute")}]}};if(null!==a.path)e.when(a.path,g);else{var h=c.where(x.config.routes,{path:null});if(!h||1!==h.length)throw new Error("You can only specify ONE null route in the routes config block!!!",h);e.otherwise(g),m=!1,x.config.routes.push(a)}return x},r=function(a,d){var e="ht"+c.string.classify(a);if(!f.components[e]){f.components[e]=!0;var i={restrict:"EA",templateUrl:a.toLowerCase(),replace:!0,scope:{}};c.extend(i,d);var k,l,m=i.controller;k=i.page?["ComponentFactoryService","$injector","$scope",function(d,e,f){var g=this,h=b.element(".ht-"+c.str.slugify(a));d.init(a,f,h,null,g),h.data("$WilsonComponentController",g),e.invoke(m,g,{$scope:f,$element:h}),f.checkViewDependencies()}]:["ComponentFactoryService","$injector","$scope","$element","$attrs",function(b,c,d,e,f){var g=this;b.init(a,d,e,f,g),e.data("$WilsonComponentController",g),c.invoke(m,g,{$scope:d,$element:e,$attrs:f}),d.parentComponent.registerViewDependency()}],i.controller=k;var l,n=i.link;l=n?function(a,b,c,d){n(a,b,c,d),a.checkViewDependencies()}:function(a){a.checkViewDependencies()},i.link=l;var o=!1;if(i.page){o=h||j;var p=o.register||o.controller;p(e,i.controller)}else o=g||j,o.directive(e,function(){return i})}},s=function(a,b){var d="ht"+c.string.classify(a);if(!f.behaviors[d]){f.behaviors[d]=!0;var e=g||j;if(c.isFunction(b)||c.isArray(b))e.directive(d,b);else{var h={restrict:"A"};c.extend(h,b),e.directive(d,function(){return h})}}},t=function(a,b){l("filter",a,b);var d=c.string.camelize(a);f.filters[d]||(f.filters[d]=!0,j.filter(d,c.isArray(b)?b:function(){return b}))},u=function(a,b){if(l("service",a,b),!f.services[a]){f.services[a]=!0;var c=i||j;c.factory(a,b)}},v=function(a,b,c){if(l("parser",a,b),!f.parsers[a]){f.parsers[a]=!0;var d=i||j;d.factory(a,["ParserFactoryService",function(a){var d=a.create(b,c);return new d}])}},w=function(a,b){if(l("guide",a,b),!f.guides[a]){f.guides[a]=!0;var d=g||j;d.directive(c.string.camelize(a),["i18nextService",function(){return{restrict:"A",link:function(d){var e=function(){var d={id:a,showPrevButton:!0};return c.extend(d,b())};d.$on("start-"+a,function(){hopscotch.startTour(e())}),d.$on("stop-"+a,function(){hopscotch.endTour()})}}}])}},x={utils:{getMSIEVersion:k},config:d,setAppConfig:n,embellishModel:o,component:r,filter:t,behavior:s,service:u,parser:v,guide:w};b.wilson=a.wilson=x}(this,angular,_),function(a,b){function c(){var a=this;a._listeners={},a.id=Math.floor(100*Math.random())+1;var c=function(b,c){"undefined"==typeof a._listeners[b]&&(a._listeners[b]=[]),a._listeners[b].push(c)},d=function(c,d){if("string"==typeof c&&(c=b.extend({},d,{type:c})),c.target||(c.target=this),!c.type)throw new Error('Event object missing "type" property.');if(a._listeners[c.type]instanceof Array)for(var e=a._listeners[c.type],f=0,g=e.length;g>f;f++)e[f].call(this,c)},e=function(b,c){if(a._listeners[b]instanceof Array)for(var d=a._listeners[b],e=0,f=d.length;f>e;e++)if(d[e]===c){d.splice(e,1);break}};a.publish=d,a.subscribe=c,a.unsubscribe=e}c.prototype={constructor:c},a.EventTarget=c}(this,_),angular.wilson.service("AppStateService",["localStorageService",function(a){var b=function(b,c,d){var e=d,f=a.get(b);return f&&c&&(e=f[c]),(_.isUndefined(e)||_.isNull(e))&&(e=d),e},c=function(b,c){var d=a.get(b)||{};return _.extend(d,c),a.add(b,d),d},d=function(a,b,d){var e={};e[b]=d,c(a,e)},e={getPersistentValue:b,setPersistentValue:d,setPersistentValues:c};return e}]),angular.wilson.service("BusFactoryService",function(){var a="default",b={},c={get:function(c){(void 0===c||""===c||null===c)&&(c=a);var d=b[c];return d||(d=b[c]=new EventTarget,d.name=c),d}};return c}),angular.wilson.service("ComponentFactoryService",["$rootScope","$timeout","StateMachineService","BusFactoryService","i18nextService","AppStateService","TranslationOverrideService","ElementHelperService","ComponentPrerenderService","DeprecatedFunctionService",function(a,b,c,d,e,f,g,h,i,j){var k=j.DeprecatedFunction,l=function(b,j,l,m,n){var o={},p={};j.componentCName=n.componentCName=b;for(var q=j.$parent;q&&!_.has(q,"componentCName");)q=q.$parent;j.parentComponent=q,q||(q=j.$parent);var r=m?m.expose:!1;r&&(q[r]=j);var s=m?m.exposeCtrl:!1;s&&(q[s]=n),j.eventBus=q?q.eventBus:d.get(),j.eventBus||(j.eventBus=d.get()),j.translate=n.translate=function(a,c){if(c=c||{},("string"!=typeof c.ns||""===c.ns)&&(c.ns=b),!p[a])if(o[a])c.ns=o[a];else if(g.hasOverride(c.ns,a)){for(var d=j.parentComponent;null!==d;d=d.parentComponent)if(g.hasOverrideForNamespace(c.ns,a,d.componentCName)){c.ns=o[a]=d.componentCName;break}c.ns===b&&(p[a]=!0)}return e.translate(a,c)},n.overrideText=function(a,c,d){g.addOverride(a,b,c),n.translate(c,{defaultValue:d})},j.stateMachine={current:"NoStateMachine"},j.trackEvent=function(){var a=_.toArray(arguments);if(!(a&&a.length>0))throw new Error("trackEvent: eventName is required");a[0]="tracking-service:"+a[0],j.$emit.apply(j,a)},j.emitComponentEvent=function(){var a=_.toArray(arguments);if(!(a&&a.length>0))throw new Error("emitComponentEvent: eventName is required");a[0]=b+":"+a[0],j.$emit.apply(j,a)},j.broadcastComponentEvent=function(){var a=_.toArray(arguments);if(!(a&&a.length>0))throw new Error("broadcastComponentEvent: eventName is required");a[0]=b+":"+a[0],j.$broadcast.apply(j,a)},j.defaultValue=function(a,b){var c=j[a];return(_.isUndefined(c)||_.isNull(c))&&(j[a]=b),j[a]},j.safeApply=function(b){var c=a.$$phase;"$apply"===c||"$digest"===c?b&&"function"==typeof b&&b():this.$apply(b)},j.bindToSafeApply=function(a,b){return b=b||this,a?function(){var c=arguments;j.safeApply(function(){a.apply(b,c)})}:function(){}},j.digestInProgress=function(){var b=a.$$phase;return"$apply"===b||"$digest"===b},n.setState=function(a,b){b=b||function(){};var d=j.stateMachine;if(a){var e,f=a.initial;if(m){var g=m.initialState;g&&c.hasState(a,g)&&(e=g)}var h=e||f;a.initial=h,d=j.stateMachine=c.create(a)}b(d)},n.getPersistentValue=function(a,c){return f.getPersistentValue(b,a,c)},n.setPersistentValue=function(a,c){return f.setPersistentValue(b,a,c)},n.setPersistentValues=function(a){return f.setPersistentValues(b,a)},n.watchAndPersist=function(a,b){j.$watch(a,function(b){n.setPersistentValue(a,b)}),b=n.getPersistentValue(a,b),j[a]=b};var t=function(a,b){var c=j.$watch(a,b),d=j.$on("$destroy",function(){c(),d()})},u=function(a,b,c){a.subscribe(b,c);var d=j.$on("$destroy",function(){a.unsubscribe(b,c),d()})},v=function(a,b){a.add(b);var c=j.$on("$destroy",function(){a.has(b)&&a.remove(b),c()})},w=function(a,b){var c=j.$on(a,b),d=j.$on("$destroy",function(){c(),d()})},x=new k(u,this,"controller.autosubscribe","controller.auto.subscribe");n.autosubscribe=x.getFunction();var y=new k(v,this,"controller.autoadd","controller.auto.add");n.autoadd=y.getFunction();var z=new k(t,this,"controller.autoWatch","controller.auto.watch");n.autoWatch=z.getFunction(),n.auto={add:v,subscribe:u,watch:t,on:w},h.addElementSupport(n,j,l),h.addAutoMethods(l,j,n),i.addPrerenderMethods(j,n)},m={init:l};return m}]),angular.wilson.service("ComponentLoaderService",["ResourceLoaderService","$q","$http","$compile","$rootScope",function(a,b,c){var d=angular.wilson.config,e=d.app.version||"none",f=d.app.connectionFilters||[],g=d.app.updateInterval.split(" "),h={count:g[0],unit:g[1]},i="",j=d.cdn;j&&j.host&&"false"!==j.host&&(i=j.protocol+"://"+j.host,a.setResourceHost(i));var k={},l=moment(),m=function(){var a=b.defer(),e=d.client.app.mountpath+"/version";return c.get(e).success(a.resolve).error(a.reject),a.promise},n=function(a){var g=b.defer(),h=_.str.sprintf("%s/%s/component/%s",d.app.mountpath,e,a);return h=angular.wilson.utils.path.join(i,h),f&&(h+=_.str.sprintf("/%s",f)),c.get(h).success(function(a){l=moment(),g.resolve(a)}).error(g.reject),g.promise},o=function(c){var d=b.defer(),f=k[c];return f?moment().diff(l,h.unit)>h.count?m().then(function(a){a.version!==e?d.resolve({version:"out-of-date"}):(l=moment(),d.resolve(f))},d.reject):d.resolve(f):n(c).then(function(b){e===b.version?a.loadBundle(b,function(){k[c]=b,d.resolve(b)},function(){d.reject({message:"Failed to load resources for "+c})}):d.resolve(b)},d.reject),d.promise},p={load:o};return p}]),angular.module("wilson.prerender",[]).provider("ComponentPrerenderService",["$compileProvider",function(a){function b(a){var b=angular.wilson.config.prerender;b&&b.enableLogs}function c(){a.directive("ngRepeat",["$timeout",function(){return{restrict:"A",priority:-1,require:["?ngRepeat","^?WilsonComponent"],link:function(a,b,c,d){if(!window.prerenderReady){var e=(d[0],d[1]);a.$first&&e.registerViewDependency(),a.$last&&e.defferedResolveViewDependency()}}}}])}window.prerenderReady=!1,this.$get=["$timeout",function(a){function d(c,d){function e(){j++}function f(a){a=a||1,j>=a?j-=a:b("ERROR: Attempt to resolve more view deps than were added"),0===j&&(b("All view dependencies have resolved for component "+c.componentCName),c.renderComplete=!0,c.parentComponent&&c.parentComponent.componentCName?c.parentComponent.resolveViewDependency():(b("PRERENDER COMPLETE!!!"),window.prerenderReady=!0))}function g(){1>k?(k++,a(function(){a(function(){d.resolveViewDependency(k),k=0},0)},0)):k++}function h(){a(function(){a(function(){0===j&&c.parentComponent&&c.parentComponent.componentCName&&c.parentComponent.resolveViewDependency()},0)},0)}function i(a,b){d.registerViewDependency(),b||(b=function(a){return!_.isEmpty(a)});var e=c.$watch(a,function(a){b(a)&&(e(),d.defferedResolveViewDependency())})}var j=0,k=0,l={registerViewDependency:e,registerDataDependency:i,checkViewDependencies:h,resolveViewDependency:f,defferedResolveViewDependency:g};_.merge(c,l),_.merge(d,l)}function e(){}c();var f={addPrerenderMethods:d,deregisterPrerenderNgRepeat:e};return f}]}]),angular.wilson.service("DeprecatedFunctionService",[function(){function a(a,b,c,d){var e=function(){return a.apply(b,_.toArray(arguments))};this.getFunction=function(){return e}}var b={DeprecatedFunction:a};return b}]),angular.wilson.service("ElementHelperService",["DeprecatedFunctionService",function(a){var b=a.DeprecatedFunction,c=function(a,c,d){var e=function(a,b,c){c||(c=d),c.on(a,b),d.on("$destroy",function(){c.off(a,b)})},f=new b(e,this,"controller.autoOn","$element.auto.on");a.autoOn=f.getFunction();var g=function(b,e,f,g){g||(g=d),f||(f=a),g.on(b,function(){var a=_.toArray(arguments);c.$apply(function(){e.apply(f,a)})}),d.on("$destroy",function(){g.off(b,e)})},h=new b(g,this,"controller.autoApplyOn","$element.auto.applyOn");a.autoApplyOn=h.getFunction()},d=function(a,b,c){var d=function(b,c,d){d||(d=a),d.on(b,c),a.on("$destroy",function(){d.off(b,c)})},e=function(d,e,f,g){g||(g=a),f||(f=c),g.on(d,function(){var a=_.toArray(arguments);b.$apply(function(){e.apply(f,a)})}),a.on("$destroy",function(){g.off(d,e)})};a.auto={on:d,applyOn:e}},e={addElementSupport:c,addAutoMethods:d};return e}]),angular.wilson.service("ParserFactoryService",["$injector",function(a){var b=function(b,c){if("function"!=typeof b)throw new Error("Error creating parser. Param parseMethod is not a function!");return"function"!=typeof c&&(c=function(a){return a}),function(){var d=b,e=c,f=this;this.parse=function(){var b=_.toArray(arguments);return b.unshift(a),d.call(f,b)},this.serialize=function(){var b=_.toArray(arguments);return b.unshift(a),e.apply(f,b)},this.embellish=function(b){var c=_.toArray(arguments);c.unshift(a);var e=d.apply(f,c);return angular.wilson.embellishModel(b,e)},this.embellishCollection=function(a){var b=Array.prototype.slice.call(arguments);b.shift(),_.each(a,function(c,d){b.unshift(c),a[d]=f.embellish.apply(f,b),b.shift()})}}},c={create:b};return c}]),angular.wilson.service("ResourceLoaderService",["$templateCache",function(a){var b={},c={},d="";$.ajaxSetup({cache:!0});var e=function(a){d=a},f=function(a,c){c=c||$.noop;var e=angular.wilson.utils.path.join(d,a);b[a]?c():(b[a]=!1,$.getScript(e).done(function(){b[a]=!0,c()}).fail(function(){c(!1)}))},g=function(b,d,e){return c[b]?!1:(c[b]=!0,a.put(b,e),!0)},h=function(a,d,e){d=d||$.noop;var h=_.difference(a.scripts,_.keys(b)),i=_.difference(_.pluck(a.templates,"id"),_.keys(c));_.each(i,function(b){var c=_.findWhere(a.templates,{id:b});g(c.id,c.type,c.data)}),async.each(h,function(a,b){f(a,b)},function(a){a?e():d()})},i={setResourceHost:e,loadScript:f,loadTemplate:g,loadBundle:h};return i}]),angular.wilson.service("StateMachineService",["$timeout",function(a){var b=function(b,c){return _.extend(b,{setTimeout:a,clearTimeout:a.cancel}),HtStateMachine.create(b,c)},c=_.extend({},HtStateMachine);return c.create=b,c}]),angular.wilson.service("TranslationOverrideService",function(){var a={},b=function(b,c,d){var e=a[b];e||(e=a[b]={});var f=e[d];f||(f=e[d]={});var g=f[c];g||(f[c]=!0)},c=function(b,c){return a[b]&&a[b][c]},d=function(b,c,d){return a[b]&&a[b][c]&&a[b][c][d]},e={addOverride:b,hasOverride:c,hasOverrideForNamespace:d};return e}),angular.module("wilson.i18n",[]).provider("i18nextService",function(){function a(b,c,d,e){return _.isObject(b)||_.isArray(b)?(_.each(b,function(b,c,d){d[c]=a(b,c,d,e)}),d[c]):e(b,c,d)}function b(b,c){return c=c||_.identity,_.isObject(b)||_.isArray(b)?(_.each(b,function(b,d,e){e[d]=a(b,d,e,c)}),b):c(b)}var c={};this.init=function(a){c=_.extend(c,a),window.i18n.init(c)};var d=function(a){return function(b,c){return c=c||{},("string"!=typeof c.ns||""===c.ns)&&(c.ns=a),window.i18n.t(b,c)}},e=function(a){var c=d(a);return function(a,d){return d=d||{},d.ignoreKeys=d.ignoreKeys||[],b(a,function(a,b){var e=a;return _.isString(a)&&!_.contains(d.ignoreKeys,b)&&(e=c(a,d)),e})}};this.$get=["$window",function(a){return{translate:a.i18n.t,getTranslateForNamespace:d,getTranslatorForNamespace:function(a){var b={translate:d(a),translateJson:e(a)};return b},getSupportedLanguages:function(){return c.languageData?c.languageData:[]},getActiveLanguage:function(){return c.lng?c.lng:c.fallbackLng}}}]}),function(a,b){function c(a){var c=a.callbacks||{},d=a.timeouts||[],e=a.setTimeout,g=a.clearTimeout;b.each(d,function(a){var b="onenter"+a.state;c[b]=f.preprendCallback(c,b,function(){var b=this,c=function(){b[a.timeoutEvent]()};g(b.curTimeout),b.curTimeout=e(c,a.duration)}),b="onleave"+a.state,c[b]=f.preprendCallback(c,b,function(){var a=this;g(a.curTimeout)}),a.refreshEvent&&(b="onbefore"+a.refreshEvent,c[b]=f.preprendCallback(c,b,function(b,c,d,e){if(c===a.state){var f=this;f["onenter"+a.state](b,c,d,e)}}))}),a.callbacks=c}function d(a,c){var d=a.callbacks||{},e={},f=new EventTarget,g=["onbeforeevent","onleavestate","onenterstate","onafterevent"];b.each(g,function(a){!function(b){b&&f.on(a,function(a){b(a.name,a.from,a.to,a.args)})}(d[a]),e[a]=function(b,c,d,e){f.trigger({type:a,name:b,from:c,to:d,args:e})},d[a]=e[a]});var h=StateMachine.create(a,c);return h=b.extend(f,h)}function e(a,c){var d,e=c.timeouts||[],f=c.setTimeout||setTimeout,g=c.clearTimeout||clearTimeout;a.on("onenterstate",function(c){var g=b.findWhere(e,{state:c.to});g&&(d=f(function(){a[g.timeoutEvent]()},g.duration))}),a.on("onleavestate",function(){g(d)})}var f=b.extend({},StateMachine);f.create=function(a,b){var g=!1,h=null;return a.error=a.error||function(){},g?(h=d(a,b),e(h,a)):(c(a),h=StateMachine.create(a,b)),h.states=f.getStates(a),h},f.preprendCallback=function(a,b,c){var d=a[b],e=function(a,b,e,f){var g=this;c.apply(g,[a,b,e,f]),d&&d.apply(g,[a,b,e,f])};return e},f.getStates=function(a){function c(a){b.isArray(a)||(a=[a]),d=d.concat(a)}var d=[],e=a.events||[];return b.each(e,function(a){c(a.to),c(a.from)}),d=b.uniq(d)},f.hasState=function(a,c){var d=f.getStates(a);return b.indexOf(d,c)>=0?!0:!1},a.HtStateMachine=f}(this,_),function(a){var b=function(a,b,c,d){var e=[b,c];arguments.length>3&&(e=e.concat(d)),Array.prototype.splice.apply(a,e)},c=function(a,c){b(a,0,a.length,c)},d=function(a){b(a,0,a.length)};a.utils.spliceArray=b,a.utils.replaceArray=c,a.utils.clearArray=d}(angular.wilson,_),function(a,b){var c=[" Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],d=Math.log(1024);a.utils.bytesToReadable=function(a,e){if(e=b.isNumber(e)?e:1,a=parseInt(a,10),0===a)return"0 Bytes";var f=parseInt(Math.floor(Math.log(a)/d),10),g=a/Math.pow(1024,f),h=0===f?g.toString():g.toFixed(e);return h=h.replace(/\.0+$/,""),h+" "+c[f]},a.utils.getMultipleColumnSort=function(a){return function(c,d){return b.reduce(a,function(a,b){if(0===a&&c&&d)switch(!0){case c[b]>d[b]:return 1;case c[b]<d[b]:return-1;case c[b]===d[b]:return 0}return a},0)}},a.utils.generateUUID=function(){var a=(new Date).getTime(),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"===b?c:7&c|8).toString(16)});return b}}(angular.wilson,_),function(a){a.utils.printStackTrace=function(){{var a=new Error("dummy");a.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@").split("\n")}}}(angular.wilson,_),function(a){a.utils.keyCodes={KEY_CANCEL:3,KEY_HELP:6,KEY_BACK_SPACE:8,KEY_TAB:9,KEY_CLEAR:12,KEY_RETURN:13,KEY_ENTER:14,KEY_SHIFT:16,KEY_CONTROL:17,KEY_ALT:18,KEY_PAUSE:19,KEY_CAPS_LOCK:20,KEY_ESCAPE:27,KEY_SPACE:32,KEY_PAGE_UP:33,KEY_PAGE_DOWN:34,KEY_END:35,KEY_HOME:36,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_PRINTSCREEN:44,KEY_INSERT:45,KEY_DELETE:46,KEY_0:48,KEY_1:49,KEY_2:50,KEY_3:51,KEY_4:52,KEY_5:53,KEY_6:54,KEY_7:55,KEY_8:56,KEY_9:57,KEY_SEMICOLON:186,KEY_SEMICOLON_FF:59,KEY_EQUALS:61,KEY_A:65,KEY_B:66,KEY_C:67,KEY_D:68,KEY_E:69,KEY_F:70,KEY_G:71,KEY_H:72,KEY_I:73,KEY_J:74,KEY_K:75,KEY_L:76,KEY_M:77,KEY_N:78,KEY_O:79,KEY_P:80,KEY_Q:81,KEY_R:82,KEY_S:83,KEY_T:84,KEY_U:85,KEY_V:86,KEY_W:87,KEY_X:88,KEY_Y:89,KEY_Z:90,KEY_CONTEXT_MENU:93,KEY_NUMPAD0:96,KEY_NUMPAD1:97,KEY_NUMPAD2:98,KEY_NUMPAD3:99,KEY_NUMPAD4:100,KEY_NUMPAD5:101,KEY_NUMPAD6:102,KEY_NUMPAD7:103,KEY_NUMPAD8:104,KEY_NUMPAD9:105,KEY_MULTIPLY:106,KEY_ADD:107,KEY_SEPARATOR:108,KEY_SUBTRACT:109,KEY_DECIMAL:110,KEY_DIVIDE:111,KEY_F1:112,KEY_F2:113,KEY_F3:114,KEY_F4:115,KEY_F5:116,KEY_F6:117,KEY_F7:118,KEY_F8:119,KEY_F9:120,KEY_F10:121,KEY_F11:122,KEY_F12:123,KEY_F13:124,KEY_F14:125,KEY_F15:126,KEY_F16:127,KEY_F17:128,KEY_F18:129,KEY_F19:130,KEY_F20:131,KEY_F21:132,KEY_F22:133,KEY_F23:134,KEY_F24:135,KEY_NUM_LOCK:144,KEY_SCROLL_LOCK:145,KEY_COMMA:188,KEY_PERIOD:190,KEY_SLASH:191,KEY_BACK_QUOTE:192,KEY_OPEN_BRACKET:219,KEY_BACK_SLASH:220,KEY_CLOSE_BRACKET:221,KEY_QUOTE:222,KEY_META:224}}(angular.wilson),function(a,b){var c=function(a){for(var b in a)delete a[b]},d=function(a,d){c(a),b.extend(a,d)},e=function(a,b){var c=b.split("."),d=c.pop(),e=a;for(var f in c)"object"==typeof e&&(e=e[c[f]]);return"object"==typeof e?e[d]:void 0},f=function(a,b,c){var d=b.split("."),e=d.pop(),f=a;for(var g in d)"object"==typeof f&&(f=f[d[g]]);"object"==typeof f&&(f[e]=c)},g=function(a,c,d,e){d=d||[],e=e||[];var f=b.omit(b.pick(a,d),e),g=!0;return b.each(f,function(a,d){g=g&&b.isEqual(a,c[d])}),g};a.utils.clearObject=c,a.utils.replaceObject=d,a.utils.fieldsEqual=g,a.utils.setPropFromPath=f,a.utils.getPropFromPath=e}(angular.wilson,_),function(a,b){var c={detectBrowser:function(){var a={},c=function(a,b){var c=a.indexOf(b);if(-1!==c)return parseFloat(a.substring(c+b.length+1))},d=!1;return b.each(this.dataBrowser,function(b){if(d)a[b.identity.toLowerCase()]=!1;else{var e=b.string&&-1!==b.string.indexOf(b.subString)||b.prop&&-1!==b.prop.indexOf(b.subString);e?(a[b.identity.toLowerCase()]=!0,d=!0,a.version=c(navigator.userAgent,b.versionSearch||b.identity)||c(navigator.appVersion,b.versionSearch||b.identity)):a[b.identity.toLowerCase()]=!1}}),a},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",identity:"OmniWeb",versionSearch:"OmniWeb/"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"MSIE",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};a.utils.browser=c.detectBrowser()}(angular.wilson,_),function(){var a=function(a){var b=new Image;b.src=a+"?date="+(new Date).getTime()};angular.wilson.utils.sendPing=a}(angular.wilson,_),function(a){a.utils.parseBoolean=function(a){var b=String(a).toLowerCase();switch(b){case"false":case"nan":case"undefined":case"null":case"0":return!1}return!0}}(angular.wilson,_),function(a,b){var c=" /",d=function(a){return a?(a=String(a),decodeURIComponent(a.replace(/\+/g,"%20"))):""},e=function(){var a=null,d=b.toArray(arguments);if(d)if(1===d.length)a=d[0];else if(d.length>1){var e=[];e.push(b.str.rtrim(d.shift(),c));var f=b.str.ltrim(d.pop(),c);b.each(d,function(a){e.push(b.str.trim(a,c))}),e.push(f),a=e.join("/")}return a},f={join:e};a.utils.path=f,a.utils.decodeURL=d}(angular.wilson,_);